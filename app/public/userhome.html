<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Gymate</title>
    <link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png">
    <link rel="manifest" href="favicons/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="css/userhome.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>

<body>

    <nav role="navigation red">
        <div class="nav-wrapper container">
            <a id="logo-container" href="userhome.html" class="brand-logo">
                <img src="gymate-logo-final.png" id="logo">
            </a>
            <ul class="right">
                <li><a href="profile.html" id="navprofile">Profile</a></li>
            </ul>
        </div>
    </nav>

    <br>


    <div class="container" id="main">

        <div class="card-panel">
            <span class="card-title">Popular Routines</span>
            <div class="carousel">
                <a id="yo" class="carousel-item" href="#one!"></a>
                <a class="carousel-item" href="#two!"></a>
                <a class="carousel-item" href="#three!"></a>
                <a class="carousel-item" href="#four!"></a>
                <a class="carousel-item" href="#five!"></a>
            </div>
        </div>

        <div class="row">
            <div class="col s6">
                <div class="card-panel">
                    <span class="card-title">You vs. Buddy</span>
                </div>
            </div>



            <div class="col s6">
                <div class="card-panel">
                    <span class="card-title">Posts</span>
                    <div class="row">
                        <form class="col s12">
                            <div class="row">
                                <div class="input-field col s12">
                                    <textarea id="textarea1" class="materialize-textarea"></textarea>
                                    <label for="textarea1">How was your workout?</label>
                                    <button id="send-post" class="btn waves-effect waves-light" type="submit"
                                        name="action">Send</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <ul class="collection"></ul>
                </div>
            </div>
        </div>



    </div>


    <!-- 

    <div class="container" id="main">

        <div class="center card-panel">
            <h3>Favorite Routines</h3>
            <div class="carousel">        
                 <div class="carousel-item " >
                    <p>Beginner</p>
  
                    <div class="carousel-fixed-item center">
                        <a class="btn routine waves-effect white grey-text darken-text-2" data-index = "0" >Select</a>
                    </div>
                 </div>
                
                <div class="carousel-item " data-index = "1"><p>Intermediate</p>

                  <div class="carousel-fixed-item center">
                        <a class="btn routine waves-effect white grey-text darken-text-2" data-index = "1" >Select</a>
                    </div>
                </div>

                <div class="carousel-item" data-index = "2">
                <p>Advanced</p>

                  <div class="carousel-fixed-item center">
                        <a class="btn routine waves-effect white grey-text darken-text-2" data-index = "2" >Select</a>
                    </div>
                </div>
              
            </div>
        </div>

        <div class="row">
            <div class="col s3">
                <div class="card-panel center">
                    <h3>You</h3>
                    <div id = "me"></div>

                </div>
            </div>
            <div class="col s3">
                <div class="card-panel center">
                    <h3>Buddy</h3>
                    <div id = "buddy"></div>
                </div>
            </div>


            <div class="col s6">
                <div class="card-panel center">
                    <h3>All Posts</h3>
                </div>
            </div>

        </div>



    </div> -->

    <nav role="navigation red">
        <div class="nav-wrapper container">
            <div class="container center">
                <footer>Â© 2019 Copyright</footer>
            </div>
        </div>
    </nav>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        var colors = ["red", "yellow", "green", "blue", "orange", "purple"];

        $(".carousel-item").each(function (index) {
            $(this).attr("style", `background: ${colors[index]};`)
        });

        function getUser(id, cb) {
            $.get("api/users/" + id).
                then(function (data) {
                    console.log(data);
                    cb(data)
                });
        };

        function displayAllPosts() {
            $.get("api/posts").
                then(function (data) {

                    console.log(data);
                    for (var i = 0; i < data.length; i++) {

                        cb = function (i, userData) {
                            var post = $("<li class='collection-item avatar'>");
                            var imgId = "post-img" + i;
                            var nameId = "post-name" + i;
                            var contentId = "post-content" + i;

                            post.append(`<img id='${imgId}' class='circle'>`);
                            post.append(`<span id='${nameId}' class='title'></span>`);
                            post.append(`<p id='${contentId}'>`);

                            $(".collection").append(post);

                            $("#" + imgId).attr('src', userData.profilePhoto);
                            $("#" + nameId).text(userData.name);
                            $("#" + contentId).text(data[i].content);


                        }
                        getUser(data[i].UserId, cb.bind(null, i));
                    }
                });


        };

        $(document).ready(function () {

            var buddyId;
            var userId = 1;
            var routineIndex;
            var selected = false;


            var Routine1 = ["Chest, Back, Shoulders, Legs, Biceps, Triceps", "Rest", "Rest", "Legs, Triceps, Biceps, Chest, Back, Shoulder", "Rest", "Shoulders, Back, Chest, Legs, Triceps, Biceps", "Rest"];
            var Routine2 = ["Chest, Shoulders and Triceps", "Back and Biceps", "Rest", "Legs", "Rest", "Shoulders, chest, and Triceps", "Back and Bis", "Rest"];
            var Routine3 = ["Chest & Back", "Legs", "Shoulders & Arms", "Rest", " Chest, Shoulders, & Triceps", "Back & Biceps", " Legs"];





            var routineArr = [Routine1, Routine2, Routine3];


            function updateUserRoutine(userId) {

            }






            function addRoutine(routine) {

                console.log(routine);


                for (var i = 0; i < 7; i++) {
                    var dailyRoutine =
                    {
                        dayOfTheWeek: i + 1,
                        routine: routine[i],
                        UserId: userId
                    }

                    $.ajax({
                        method: "POST",
                        url: "/api/routines/" + userId,
                        data: dailyRoutine
                    }).then(function (data) {

                        console.log(data);
                    });
                }

            }

            $(".routine").click(function (e) {

                routineIndex = parseInt($(this).attr("data-index"));
                console.log(routineIndex);
                if (!selected) {
                    addRoutine(routineArr[routineIndex]);
                    selected = true;
                }
                else {

                }

            });



        });

        $('.carousel').carousel();
        displayAllPosts();

        $("#send-post").on("click", (e) => {
            e.preventDefault();

            var contentToPost = $("#textarea1").val().trim();
            // if(!contentId) {
            //     alert()
            // }
            $("#textarea1").val("");
            $("#textarea1").next().removeClass("active");

            var postText = {

                content: contentToPost,
                userId: 1
            };

            $.post("api/posts", postText).
                then(function (data) {

                    console.log(data);

                    alert("Adding post...");
                });
            $(".collection").empty();
            displayAllPosts();
        });
    </script>
</body>

</script>

</body>



</html>